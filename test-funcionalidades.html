<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test de Funcionalidades - MCM Buga</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            line-height: 1.6;
        }
        .test-section { 
            margin: 20px 0; 
            padding: 15px; 
            border: 1px solid #ddd; 
            border-radius: 8px;
        }
        .test-passed { 
            background-color: #d4edda; 
            border-color: #c3e6cb;
        }
        .test-failed { 
            background-color: #f8d7da; 
            border-color: #f5c6cb;
        }
        .test-warning { 
            background-color: #fff3cd; 
            border-color: #ffeaa7;
        }
        .test-button { 
            background: #007bff; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            border-radius: 5px; 
            cursor: pointer; 
            margin: 5px;
        }
        .test-button:hover { 
            background: #0056b3; 
        }
        .status { 
            font-weight: bold; 
            padding: 5px 10px; 
            border-radius: 3px;
        }
        .passed { 
            background: #28a745; 
            color: white; 
        }
        .failed { 
            background: #dc3545; 
            color: white; 
        }
        .warning { 
            background: #ffc107; 
            color: black; 
        }
    </style>
</head>
<body>
    <h1>üß™ Test de Funcionalidades - MCM Buga</h1>
    <p>Este test verifica que todas las funcionalidades del sitio web funcionen correctamente.</p>
    
    <div id="test-results"></div>
    
    <div class="test-section">
        <h2>Controles de Test</h2>
        <button class="test-button" onclick="runAllTests()">üîÑ Ejecutar Todos los Tests</button>
        <button class="test-button" onclick="testThemeToggle()">üåô Test Tema Oscuro</button>
        <button class="test-button" onclick="testDetailsToggle()">üìñ Test Expandir Detalles</button>
        <button class="test-button" onclick="testAudioPlayers()">üéµ Test Reproductores Audio</button>
        <button class="test-button" onclick="testFormValidation()">üìù Test Formularios</button>
        <button class="test-button" onclick="testNavigation()">üß≠ Test Navegaci√≥n</button>
        <button class="test-button" onclick="clearResults()">üóëÔ∏è Limpiar Resultados</button>
    </div>

    <script>
        let testResults = [];

        function addTestResult(testName, status, message, details = '') {
            testResults.push({
                name: testName,
                status: status,
                message: message,
                details: details,
                timestamp: new Date().toLocaleTimeString()
            });
            updateTestDisplay();
        }

        function updateTestDisplay() {
            const resultsDiv = document.getElementById('test-results');
            resultsDiv.innerHTML = testResults.map(result => `
                <div class="test-section test-${result.status}">
                    <h3>${result.name} <span class="status ${result.status}">${result.status.toUpperCase()}</span></h3>
                    <p><strong>Resultado:</strong> ${result.message}</p>
                    ${result.details ? `<p><strong>Detalles:</strong> ${result.details}</p>` : ''}
                    <small>Ejecutado: ${result.timestamp}</small>
                </div>
            `).join('');
        }

        function clearResults() {
            testResults = [];
            updateTestDisplay();
        }

        // Test 1: Verificar que todos los archivos CSS se carguen
        function testCSSFiles() {
            const cssFiles = [
                './assets/css/variables.css',
                './assets/css/components.css',
                './assets/css/layout.css',
                './assets/css/interactive.css'
            ];
            
            let loadedFiles = 0;
            let totalFiles = cssFiles.length;
            
            cssFiles.forEach(file => {
                const link = document.createElement('link');
                link.rel = 'stylesheet';
                link.href = file;
                link.onload = () => {
                    loadedFiles++;
                    if (loadedFiles === totalFiles) {
                        addTestResult('Carga de CSS', 'passed', 'Todos los archivos CSS se cargaron correctamente', `${loadedFiles}/${totalFiles} archivos cargados`);
                    }
                };
                link.onerror = () => {
                    addTestResult('Carga de CSS', 'failed', `Error al cargar: ${file}`, 'Verificar que el archivo existe y la ruta es correcta');
                };
                document.head.appendChild(link);
            });
        }

        // Test 2: Verificar que todos los archivos JavaScript se carguen
        function testJSFiles() {
            const jsFiles = [
                './assets/js/utils.js',
                './assets/js/security.js',
                './assets/js/interactivity.js',
                './assets/js/image-optimization.js',
                './assets/js/live-streaming.js',
                './assets/js/analytics.js'
            ];
            
            let loadedFiles = 0;
            let failedFiles = [];
            
            jsFiles.forEach(file => {
                const script = document.createElement('script');
                script.src = file;
                script.onload = () => {
                    loadedFiles++;
                    if (loadedFiles + failedFiles.length === jsFiles.length) {
                        if (failedFiles.length === 0) {
                            addTestResult('Carga de JavaScript', 'passed', 'Todos los archivos JS se cargaron correctamente', `${loadedFiles}/${jsFiles.length} archivos cargados`);
                        } else {
                            addTestResult('Carga de JavaScript', 'warning', `${loadedFiles} archivos cargados, ${failedFiles.length} fallaron`, `Archivos fallidos: ${failedFiles.join(', ')}`);
                        }
                    }
                };
                script.onerror = () => {
                    failedFiles.push(file);
                    if (loadedFiles + failedFiles.length === jsFiles.length) {
                        addTestResult('Carga de JavaScript', 'failed', `Error al cargar archivos JS`, `Archivos fallidos: ${failedFiles.join(', ')}`);
                    }
                };
                document.head.appendChild(script);
            });
        }

        // Test 3: Verificar funcionalidad del tema oscuro
        function testThemeToggle() {
            try {
                // Crear bot√≥n de prueba si no existe
                let themeButton = document.getElementById('theme-toggle');
                if (!themeButton) {
                    themeButton = document.createElement('button');
                    themeButton.id = 'theme-toggle';
                    themeButton.innerHTML = '<i class="fas fa-moon"></i>';
                    document.body.appendChild(themeButton);
                }

                const initialTheme = document.body.classList.contains('dark-theme');
                
                // Simular click
                themeButton.click();
                
                setTimeout(() => {
                    const newTheme = document.body.classList.contains('dark-theme');
                    if (newTheme !== initialTheme) {
                        addTestResult('Toggle Tema', 'passed', 'El cambio de tema funciona correctamente', `Cambi√≥ de ${initialTheme ? 'oscuro' : 'claro'} a ${newTheme ? 'oscuro' : 'claro'}`);
                    } else {
                        addTestResult('Toggle Tema', 'failed', 'El cambio de tema no funciona', 'El tema no cambi√≥ despu√©s del click');
                    }
                }, 100);
                
            } catch (error) {
                addTestResult('Toggle Tema', 'failed', 'Error en el test de tema', error.message);
            }
        }

        // Test 4: Verificar expansi√≥n de detalles
        function testDetailsToggle() {
            try {
                const detailsButtons = document.querySelectorAll('.toggle-details');
                if (detailsButtons.length === 0) {
                    addTestResult('Toggle Detalles', 'warning', 'No se encontraron botones de detalles', 'Crear elementos de prueba para verificar funcionalidad');
                    return;
                }

                const firstButton = detailsButtons[0];
                const cardBody = firstButton.closest('.card-body');
                
                if (!cardBody) {
                    addTestResult('Toggle Detalles', 'failed', 'Estructura HTML incorrecta', 'No se encontr√≥ .card-body');
                    return;
                }

                const details = cardBody.querySelector('.details');
                if (!details) {
                    addTestResult('Toggle Detalles', 'failed', 'No se encontr√≥ elemento .details', 'Verificar estructura HTML');
                    return;
                }

                const initialDisplay = details.style.display;
                firstButton.click();
                
                setTimeout(() => {
                    const newDisplay = details.style.display;
                    if (newDisplay !== initialDisplay) {
                        addTestResult('Toggle Detalles', 'passed', 'La expansi√≥n de detalles funciona correctamente', `Cambi√≥ de "${initialDisplay}" a "${newDisplay}"`);
                    } else {
                        addTestResult('Toggle Detalles', 'failed', 'La expansi√≥n de detalles no funciona', 'El display no cambi√≥');
                    }
                }, 100);

            } catch (error) {
                addTestResult('Toggle Detalles', 'failed', 'Error en test de detalles', error.message);
            }
        }

        // Test 5: Verificar reproductores de audio
        function testAudioPlayers() {
            const audioPlayers = document.querySelectorAll('audio');
            if (audioPlayers.length === 0) {
                addTestResult('Reproductores Audio', 'warning', 'No se encontraron reproductores de audio', 'Verificar que existan elementos <audio> en la p√°gina');
                return;
            }

            let workingPlayers = 0;
            let totalPlayers = audioPlayers.length;

            audioPlayers.forEach((audio, index) => {
                if (audio.canPlayType) {
                    const source = audio.querySelector('source');
                    if (source && source.src) {
                        workingPlayers++;
                    }
                }
            });

            if (workingPlayers === totalPlayers) {
                addTestResult('Reproductores Audio', 'passed', 'Todos los reproductores est√°n configurados correctamente', `${workingPlayers}/${totalPlayers} reproductores funcionando`);
            } else {
                addTestResult('Reproductores Audio', 'warning', 'Algunos reproductores tienen problemas', `${workingPlayers}/${totalPlayers} reproductores configurados correctamente`);
            }
        }

        // Test 6: Verificar validaci√≥n de formularios
        function testFormValidation() {
            const forms = document.querySelectorAll('form');
            if (forms.length === 0) {
                addTestResult('Validaci√≥n Formularios', 'warning', 'No se encontraron formularios', 'No hay formularios para validar');
                return;
            }

            let formsWithValidation = 0;
            forms.forEach(form => {
                const requiredFields = form.querySelectorAll('[required]');
                if (requiredFields.length > 0) {
                    formsWithValidation++;
                }
            });

            if (formsWithValidation > 0) {
                addTestResult('Validaci√≥n Formularios', 'passed', 'Formularios con validaci√≥n encontrados', `${formsWithValidation}/${forms.length} formularios tienen campos requeridos`);
            } else {
                addTestResult('Validaci√≥n Formularios', 'warning', 'No se encontr√≥ validaci√≥n en formularios', 'Considerar agregar atributos required');
            }
        }

        // Test 7: Verificar navegaci√≥n suave
        function testNavigation() {
            const navLinks = document.querySelectorAll('a[href^="#"]');
            if (navLinks.length === 0) {
                addTestResult('Navegaci√≥n', 'warning', 'No se encontraron enlaces de navegaci√≥n interna', 'No hay enlaces con href="#"');
                return;
            }

            let workingLinks = 0;
            navLinks.forEach(link => {
                const href = link.getAttribute('href');
                const target = document.querySelector(href);
                if (target) {
                    workingLinks++;
                }
            });

            if (workingLinks === navLinks.length) {
                addTestResult('Navegaci√≥n', 'passed', 'Todos los enlaces de navegaci√≥n funcionan', `${workingLinks}/${navLinks.length} enlaces v√°lidos`);
            } else {
                addTestResult('Navegaci√≥n', 'warning', 'Algunos enlaces no tienen destino v√°lido', `${workingLinks}/${navLinks.length} enlaces funcionando`);
            }
        }

        // Test 8: Verificar responsive design
        function testResponsiveDesign() {
            const viewport = document.querySelector('meta[name="viewport"]');
            const mobileToggle = document.querySelector('.mobile-toggle');
            
            let score = 0;
            let details = [];

            if (viewport) {
                score++;
                details.push('‚úì Meta viewport configurado');
            } else {
                details.push('‚úó Meta viewport no encontrado');
            }

            if (mobileToggle) {
                score++;
                details.push('‚úì Bot√≥n de men√∫ m√≥vil encontrado');
            } else {
                details.push('‚úó Bot√≥n de men√∫ m√≥vil no encontrado');
            }

            if (score === 2) {
                addTestResult('Dise√±o Responsive', 'passed', 'Dise√±o responsive configurado correctamente', details.join(', '));
            } else if (score === 1) {
                addTestResult('Dise√±o Responsive', 'warning', 'Dise√±o responsive parcialmente configurado', details.join(', '));
            } else {
                addTestResult('Dise√±o Responsive', 'failed', 'Dise√±o responsive no configurado', details.join(', '));
            }
        }

        // Ejecutar todos los tests
        function runAllTests() {
            clearResults();
            addTestResult('Inicio de Tests', 'passed', 'Ejecutando bater√≠a completa de tests...', 'Verificando todas las funcionalidades');
            
            setTimeout(() => testCSSFiles(), 100);
            setTimeout(() => testJSFiles(), 200);
            setTimeout(() => testThemeToggle(), 300);
            setTimeout(() => testDetailsToggle(), 400);
            setTimeout(() => testAudioPlayers(), 500);
            setTimeout(() => testFormValidation(), 600);
            setTimeout(() => testNavigation(), 700);
            setTimeout(() => testResponsiveDesign(), 800);
            
            setTimeout(() => {
                const passedTests = testResults.filter(r => r.status === 'passed').length;
                const totalTests = testResults.length - 1; // -1 para excluir "Inicio de Tests"
                addTestResult('Resumen Final', 'passed', `Tests completados: ${passedTests}/${totalTests} exitosos`, 'Revisa los resultados individuales para m√°s detalles');
            }, 1000);
        }

        // Ejecutar tests autom√°ticamente al cargar
        window.addEventListener('load', () => {
            setTimeout(runAllTests, 1000);
        });
    </script>
</body>
</html>
